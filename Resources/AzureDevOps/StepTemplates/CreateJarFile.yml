parameters:
  DockerfileContext: ''

steps:
  - script: dir $(Build.SourcesDirectory)
  - task: DeleteFiles@1
    displayName: 'Remove unneeded jar files Java Plugins/target folder'
    inputs:
      sourceFolder: '$(Build.SourcesDirectory)/dfc-servicetaxonomy-editor/DFC.ServiceTaxonomy.Neo4j/Java Plugins/target'
      contents: '*.jar'
  - template: MavenBuild.yml
    parameters:
      mavenPomFile: 'dfc-servicetaxonomy-editor/DFC.ServiceTaxonomy.Neo4j/Java Plugins/pom.xml'
      mavenOptions: '-Xmx3072m'
      javaHomeOption: 'JDKVersion'
      jdkVersionOption: '1.11'
      jdkArchitectureOption: 'x64'
      publishJUnitResults: false
  - task: DeleteFiles@1
    displayName: 'Remove unneeded jar files from the maven build target folder'
    inputs:
      sourceFolder: 'dfc-servicetaxonomy-editor/DFC.ServiceTaxonomy.Neo4j/Java Plugins/target'
      contents: original*.jar
  - script: mkdir '${{ parameters.DockerfileContext }}/plugins'
    displayName: 'md plugins folder under Dockerfiles'
  - task: CopyFiles@2
    displayName: copy jar file to dockerfiles/plugins folder
    inputs:
      contents: 'dfc-servicetaxonomy-editor/DFC.ServiceTaxonomy.Neo4j/Java Plugins/target/*.jar'
      targetFolder: '${{ parameters.DockerfileContext }}/plugins'
      flattenFolders: true
  - script: dir '${{ parameters.DockerfileContext }}/plugins'
    displayName: 'dir Dockerfiles/plugins folder - sanity check'


        